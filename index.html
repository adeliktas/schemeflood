<!DOCTYPE html>
<html lang="en">
<head>
	<!-- english translation via google, fork of @adeliktasde from https://github.com/TomAPU/schemeflood -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <button onclick="startdetection();">一Button to get installed programs</button>
    <br>
    <textarea rows="30" cols="30" id="notinstall">Not installed (or installed unregisteredscheme）:</textarea>
    <textarea rows="30" cols="30" id="installed">Installed (or once installed but not cleaned up when uninstalledscheme）:</textarea>
    <h1>Based on<a href="https://fingerprintjs.com/blog/external-protocol-flooding/">Schemeflood</a>technology to detect installed software</h1>
	<h1>It has been tested in a Windows+Chrome90 environment, do not move out of this interface or tap the screen to ensure accurate results</h1>
	<h1>Currently, this test does not support Safari, but <a href="https://schemeflood.com/">the demo of the creator of this technology</a> can support</h1> 
    <h1>The test results will not be uploaded, this page is open source, please rest assured to test</h1> 
    <!--I really don’t know how to write the front end, so let’s do it--> 
</head>
<body>

    <script>

    function sleep(ms) 
    {
        return new Promise(resolve => setTimeout(resolve, ms));
    }


    async function startdetection()
    {
        handler = window.open('about:blank', '', 'width=50,height=50,left=9999,top=9999')
        //Thanks @studentmain for adding the fingerprint library of the proxy software 
        appnames=['Skype', 'Spotify', 'Zoom', 'vscode', 'Epic Games', 'Telegram', 'Discord', 'Slack', 'Steam', 'Battle.net', 'Xcode', 'NordVPN', 'Sketch', 'Teamviewer', 'Microsoft Word', 'WhatsApp', 'Postman', 'Adobe', 'Messenger', 'Figma', 'Hotspot Shield', 'ExpressVPN', 'Notion', 'iTunes','Tim','百度网盘','BinaryNinja','evernote','github desktop','onenote','QQ','腾讯会议','xmind','Vmware','360软件管家','acrobat','QQ游戏','shadowsocks','shadowsocksr','v2ray','trojan','naiveproxy','brook','V2rayU']
        schemes=['skype', 'spotify', 'zoommtg', 'vscode', 'com.epicgames.launcher', 'tg', 'discord', 'slack', 'steam', 'battlenet', 'xcode', 'nordvpn', 'sketch', 'teamviewerapi', 'word', 'whatsapp', 'postman', 'aem-asset', 'messenger', 'figma', 'hotspotshield', 'expressvpn', 'notion', 'itunes','Tencent','Baiduyunguanjia','BinaryNinja','evernote','github-windows','onenote','QQ','wwauth3rd3a82ac41e00d815d','xmind','vm','softmanager360','acrobat','QQGameProtocol','ss','ssr','vmess','trojan','naive+https','brook','clash']
        for(var i=0;i<appnames.length;i++)
        {
            appname=appnames[i];
            scheme=schemes[i];
            let isDetected=true;
            await sleep(125) 
            input = document.createElement('input')
            input.style.opacity = '0'
            input.style.position = 'absolute'
            input.onfocus = () => { isDetected = false }
            await sleep(125) 
            handler.document.body.appendChild(input);
            handler.location.replace(scheme+"://Message")
            await sleep(125) 
            input.focus()
            await sleep(125)
            input.remove()
            if(isDetected)
                output=document.getElementById('installed')
            else 
                output=document.getElementById('notinstall')
            output.value+='\n'+appname
            handler.location.replace("about:blank")
        }
        handler.close()
    }

    </script>
</body>
</html>
